\subsection{\sysC: Quantifying Cipher Security
Properties}\label{subsec:des-trade}

% About: background
To reason about when to trade off between the ciphers evaluated in this work, we
must have a way to compare ciphers' utility in the context of \sys FDE. To
obtain a space of configurations that we might reason about, it is necessary to
compare certain properties of stream ciphers useful in the FDE context. However,
different ciphers have a wide range of security properties, performance
profiles, and output characteristics, including those that randomize their
outputs and those with non-length-preserving outputs---\ie{the cipher outputs
more data than it takes in}. To address this, we propose a framework for
quantitative cipher comparison in the FDE context; we use this framework to
define our configurations. \TODO{Combine what follows with what precedes.} To
address this need, we propose a novel evaluation framework. Our framework
classifies stream ciphers according to three quantitative features: relative
round count, ciphertext randomization, and ciphertext expansion. Taken together,
these features reveal a rich tradeoff space of cipher configurations optimizing
for different combinations of concerns.

Table \cref{tbl:trade} \TODO{explanation}. We limit our analysis to groups of
three implementations, each using a different number of rounds. In the case of
HC-128 and HC-256, we limit our analysis to a group of two implementations.
Scores range from 0 (least number of rounds considered) to 1 (greatest number of
rounds considered).

\input{graphics/tbl-trade}

% ---------------------------------- RR

\mysub{Relative Rounds (Rounds).} The ciphers we examine in this paper are all
constructed around the notion of \emph{rounds}, where a higher number of rounds
(and possibly longer key) is positively correlated with a higher resistance to
brute force given no fatal related-key or other
attacks~\cite{ChaCha-Cryptanalysis}. Hence, this feature represents how many
rounds a cipher executes relative to other implementations of the same
algorithm. For instance: ChaCha8 is a reduced-round version of ChaCha12, which
is a reduced-round version of ChaCha20, all using the ChaCha
algorithm~\cite{ChaCha20,ChaCha-Cryptanalysis}.

% ---------------------------------- CR

\mysub{Ciphertext Randomization (Randomization).} A cipher with ciphertext
randomization generates different ciphertexts non-deterministically given the
same key, nonce, and plaintext. This makes it much more difficult to execute
chosen-ciphertext attacks (CCA), key re-installation attacks, XOR-based
cryptanalysis and other comparison attacks, and other confidentiality-violating
schemes where the ciphertext is in full control of the adversary
~\cite{Freestyle}. This property is useful in cases where we cannot prevent the
same key, nonce, and plaintext from being reused, such as with data ``in
motion'' (see the motivational example earlier in this work). Ciphers without
this property---such as ChaCha20 on which prior work is based---are trivially
broken when key-nonce-plaintext 3-tuples are reused. In StrongBox, this is
referred to as an ``overwrite condition'' or simply
``overwrite''~\cite{StrongBox}.

Though there are many ways to achieve ciphertext randomization, the ciphers
included in our analysis implement it using a random number of rounds for each
block of the message where the exact number of rounds are unknown to the
receiver a priori~\cite{Freestyle}. In determining the minimum and maximum
number of rounds used per block in this non-deterministic mode of operation, we
can customize the computational burden an attacker must bear by choosing lower
or higher minimums and maximums. Hence, this is not a binary feature; scores
range from 0 (no ciphertext randomization) to 1 (lowest minimum and maximum
rounds per block) to 3 (highest minimum and maximum rounds per block).

% ---------------------------------- CE

\mysub{Ciphertext Expansion (Expansion).} A cipher that exhibits ciphertext
expansion is non-length-preserving: it outputs more or less ciphertext than was
originally input as plaintext. This can cause major problems in the FDE context.
For instance, cryptosystems that rely on AES-XTS (e.g. Linux's dm-crypt,
Microsoft's BitLocker, Apple's FileVault) or ChaCha (e.g. StrongBox, Google's
Adiantum) have storage layouts that hold length-preserving output as an
invariant, making ciphers that do not exhibit this property incompatible with
their implementations; yet, ciphertext expansion is often (but not always) a
necessary side-effect of ciphertext randomization.

The ciphers included in our analysis that exhibit ciphertext expansion have an
overhead of around 1.56\% per plaintext message block~\cite{Freestyle}. Even a
single byte of additional ciphertext vs plaintext would make a cipher
inappropriate for use with prior work. Hence, this is a binary feature in that a
cipher either outputs ciphertext of the same length as its plaintext input or it
does not. A cipher scores either a 0 if it \emph{is not} length-preserving in
this way or a 1 if the ciphertext is always the same length as the plaintext.

\TODO{Give an example here of how these would be used to judge a cipher and
why.}

