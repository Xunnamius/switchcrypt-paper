\section{Implementation}\label{subsec:implementation}

Our \sys implementation consists of \locTotal lines of C code (excluding
StrongBox components that we re-use as is). To ensure high quality code, we also
wrote \locTest lines of test suite. All will be made open source to the public.
We currently deploy \sys on top of the BUSE virtual block device~\cite{BUSE} as
our mock device controller. BUSE is a thin (200 LoC) wrapper around the standard
Linux Network Block Device (NBD). BUSE allows an operating system to transact
block I/O requests to and from virtual block devices exposed via domain socket.

\input{graphics/tbl-impl}

For the ciphers we support, we select five types of ciphers for the purpose of
this research: ChaCha8 and ChaCha20~\cite{ChaCha20}, Freestyle~\cite{Freestyle}
in three different configurations: a ``fast'' mode with parameters
\texttt{FFast($R_{min}$=$8$,$R_{max}$=$20$,$H_I$=$4$,$I_C$=$8$)}, a ``balanced''
mode with parameters \texttt{FBalanced($R_{min}$=$12$,
$R_{max}$=$28$,$H_I$=$2$,$I_C$=$10$)}, and a ``strong'' mode with parameters
\texttt{FStrong($R_{min}$=$20$,$R_{max}$=$36$,$H_I$=$1$,$I_C$=$12$)}. \hsg{how
about AES-XTRS and AES-CTR, and eSTREAM?? how should I reconcile these ``5''
ciphers with more of the ciphers listed in Table \tblref{impl}. I thought you
support more than five??}

Table \tblref{impl} shows the source of the cipher code that we use, but as
mentioned in Section \ref{design-crypts-pls-fix-this}, they must be repackaged
with the \sysB interface.

