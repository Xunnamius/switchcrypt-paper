\section{\sys Design}\label{sec:des}

% About: basics, dependent
\sys is a block layer kernel module that can replace other state-of-the-art
block-level encryption technologies such as the popular dm-crypt. \sys does not
require any modification in the application and, when using the Selective
switching model, only a small modification in the file system layer to expose
the inode-block mapping. The choice to implement \sys at the block layer is
important to ensure the core logic of file systems does not have to be modified
and that all metadata is encrypted and protected. Just like any other encryption
technology, \sys must have a unit of encryption/decryption. In this paper we
call that unit a ``nugget,'' which can be configured as one or more sequential
blocks.

To provide kernel support for heterogeneous FDE and live cipher switching, we
must address three key challenges:

\begin{enumerate}

\item We must provide switching models that cover the temporal and spatial
  nature of storage data and accesses to support the flexible heterogeneous
  encryption that users demand. For this, we introduce the \sysA
  (\cref{subsec:des-switch}) component of \sys that exposes three switching
  models to users: Forward, Selective and Mirrored switching.

\item We must allow arbitrary cipher implementations to be easily integrated
  into \sys. This is non-trivial, however, as different ciphers and encryption
  modes require different inputs, generate disparate outputs, and are often
  tightly coupled to the storage/encryption layer itself. For this, we introduce
  the \sysB (\cref{subsec:des-crypts}) component where we decouple cipher
  implementations from the core encryption algorithm by providing wrapper
  interfaces that allows different encryption algorithms (``crypts'') to
  co-exist in the storage layer.

\item We must help users understand the tradeoffs of different cipher
  configurations, hence we introduce \sysC (\cref{subsec:des-trade}), a method
  that attempts to quantify the desirable properties of different cipher
  configurations using several metrics such as the round count, ciphertext
  randomization, and ciphertext expansion cost.

\end{enumerate}

