\section{Introduction}\label{sec:introduction}

There are several important concerns modern filesystems must balance. Paramount
among them are: security of data at rest; performance, \ie{I/O latency or
throughput}; and overall energy budget. However, these concerns exist in
contention with one another.

The state of the art for securing data at rest is Full-Drive Encryption
(FDE)\footnote{The common term is full-\emph{disk} encryption, but this work
targets SSDs, so we use \emph{drive}.}. FDE employs a \emph{cryptographic
cipher} to encrypt, decrypt, and authenticate backing store contents on the fly.
Understandably, this process impacts system performance and energy use
considerably. Yet, end users expect their device to be secure \emph{and}
performant \emph{and} energy efficient. The obvious solution is to balance these
concerns with respect to the most general use case, but this is not always
desirable. \TODO{Introduce two examples: 1) Android M FDE example from
Google~\cite{AndroidM}. 2) Another example from someone
else~\cite{AnotherExample}.}

FDE's impact on performance and energy efficiency depends on choice of
filesystem/mapper and the choice of cipher, as different ciphers express
different performance and efficiency characteristics while offering contrasting
security guarantees. In this way, cipher choice is perhaps the most important.

The standard choice for FDE is the relatively slow AES~\cite{AES} \emph{block
cipher} in XTS mode (AES-XTS)~\cite{AES-XTS}. Prior work~\cite{StrongBox}
introduced the motivation and method for using \emph{stream ciphers} like the
high performance ChaCha20~\cite{ChaCha20} cipher for FDE in lieu of AES-XTS.
More recent work achieves something similar, such as Google's HBSH~\cite{HBSH}
(hash, block cipher, stream cipher, hash), Adiantum~\cite{Adiantum}, and others.

The benefits of choosing a more performant cipher include increased filesystem
performance(\ie{overall reduced FDE overhead}), reduced energy use, and the
ability to encrypt devices that would otherwise be too slow or
energy-inefficient to support FDE, as was the case with many mid- and low-tier
Android devices at the time FDE was considered for Android M.

And ChaCha20 is not the only stream cipher we can choose for FDE. Other stream
ciphers exist with a variety of different performance characteristics and
opposing security properties. Some of these include: ChaCha variants with
different round counts (e.g., ChaCha8 \cite{ChaCha8} and ChaCha20
\cite{ChaCha20}), SalsaX~\cite{SalsaX}, AES in counter mode
(AES-CTR)~\cite{AES-CTR}, Rabbit~\cite{Rabbit}, Sosemanuk~\cite{Sosemanuk},
Freestyle~\cite{Freestyle}, et cetera.

In this way, the choice of (stream) cipher can be viewed as a key
\emph{configuration} parameter for systems supporting FDE; \ie{the configuration
providing the fastest I/O throughput is almost always different than the
configuration providing the strongest security guarantees, and both may differ
from the configuration that uses the least amount of energy}. Further, while the
cipher choice can be configured statically at compile- or boot-time given some
generic case, in traditional FDE, these configurations cannot adapt to changes
that might arise while the system is running. Examples include changes in
resource availability, runtime environment, energy-budget and OS ``battery
saver'' functionality.

Hence, any static configuration will inevitably sacrifice one concern for
another, even when it is not optimal. But what if our system did not have to sit
at a static configuration point, especially when another configuration becomes more
desirable later on?

\subsubsection{Our Contributions}

We introduce a simple scheme to quantify the security ``strength'' of
arbitrary stream ciphers based on a subset of properties relevant to
FDE.

Using this scheme, we then define a novel tradeoff space of competing concerns:
total energy use, cipher strength, and the performance
characteristics of various stream ciphers in the context of FDE.

Finally, we present SwitchBox, a novel design substantively expanding on prior
work by 1) decoupling the cipher implementation from the encryption mechanism,
2) allowing ciphertext from different ciphers to coexist side-by-side on the
same drive as independent units, 3) employing various \emph{switching
strategies} to ``re-cipher'' those independent units dynamically at run-time.
SwitchBox accomplishes these without significant overhead, allowing us to
navigate our space of cipher configurations online, always ensuring that the
system is sitting at the most optimal configuration.

\TODO{We demonstrate SwitchBox's effectiveness on ...; we measure using ...; we
further demonstrate with use cases ...}

\TODO{Short explanation of the remaining structure of the paper.}
